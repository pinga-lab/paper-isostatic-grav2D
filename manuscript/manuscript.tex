%\documentclass[paper,twocolumn,twoside]{geophysics}
\documentclass[manuscript,revised]{geophysics}
%\documentclass[manuscript]{geophysics}

% An example of defining macros
\newcommand{\rs}[1]{\mathstrut\mbox{\scriptsize\rm #1}}
\newcommand{\rr}[1]{\mbox{\rm #1}}

% Extra packages
\usepackage{amsmath}
\usepackage{bm}
\usepackage[pdftex,colorlinks=true]{hyperref}
\hypersetup{
	allcolors=black,
}
\usepackage{lipsum}
\usepackage[table]{xcolor}

\renewcommand{\figdir}{figures} % figure directory

\begin{document}

\title{Isostatic constraint for 2D non-linear gravity inversion on rifted margins}

\renewcommand{\thefootnote}{\fnsymbol{footnote}} 

\ms{GEO-XXXX} % manuscript number

%\address{
%\footnotemark[1]Observat\'{o}rio Nacional, \\
%Department of Geophysics, \\
%Rio de Janeiro, Brazil}
%\author{B. Marcela S. Bastos\footnotemark[1] and Vanderlei C. Oliveira Jr\footnotemark[1]}
%
%\footer{vanderlei@on.br}
%\lefthead{Bastos and Oliveira Jr.}
%\righthead{Isostatic constraint on rifted margins}

\maketitle

\begin{abstract}


We propose a non-linear gravity inversion for simultaneously estimating the 
basement and Moho geometries, as well as the depth of the reference Moho 
along a profile crossing a passive rifted margin. To obtain stable solutions, 
we impose smoothness on basement and Moho, force them to be close to previously 
estimated depths along the profile and also impose local isostatic equilibrium. 
Differently from previous methods, we introduce the information of local isostatic 
equilibrium by imposing smoothness on the lithostatic stress exerted at depth. 
Our method delimits regions that deviates and those that can be considered in local 
isostatic equilibrium by varying the weight of the isostatic constraint along the profile. 
Besides, it allows controlling the 
degree of equilibrium along the profile, so that the interpreter can obtain a set of 
candidate models that fit the observed data and exhibit different degrees of 
isostatic equilibrium. Our method also differs from earlier studies because it 
attempts to use isostasy for exploring (and not necessarily reducing) the inherent 
ambiguity of gravity methods.
Tests with synthetic data illustrate the effect of our isostatic constraint on the
estimated basement and Moho reliefs, specially at regions with pronounced crustal 
thinning, which are typical of passive volcanic margins. Results obtained by 
inverting satellite data over the 
Pelotas basin, an example of passive volcanic margin at the southern of Brazil, 
agree with previous interpretations obtained independently by combining gravity, 
magnetic and seismic data available to the petroleum industry. These results 
show that, combined with a priori information, simple isostatic assumptions can be
very useful for interpreting gravity data on passive rifted margins.


\end{abstract}

\section{Introduction}


Gravity methods have long been used to investigate the crustal structure
in local studies.
A common approach is approximate the crust by a set of juxtaposed layers
with constant or depth-dependent density distributions.
The boundaries of these juxtaposed layers are defined by surfaces 
that generally represent sedimentary layers, bathymetry, relief of basement or 
the Mohorovicic discontinuity (or simply Moho).
Here, we consider methods that estimate the geometry of these surfaces.
There is a large group of methods estimating the geometry of a single surface 
representing the basement relief in the space domain
% scale: local | data: gravity | domain: space
\citep[e.g.,][]{bott1960, tanner1967, cordell-henderson1968, 
barbosa-etal1997, barbosa-etal1999, barbosa-etal1999b, condi-etal1999, silva-etal2006,  
chakravarthi-sundararajan2007, martins-etal2010, silva-etal2010, lima-etal2011, 
martins-etal2011, barnes-barraud2012, silva-etal2014, silva-santos2017},
and the Fourier domain
% scale: local | data: gravity | domain: Fourier
\citep[e.g.,][]{oldenburg1974, granser1987, reamer-ferguson1989, guspi1993}.
Another group of methods estimate a single surface representing the Moho in 
the space domain 
% scale: regional | data: gravity | domain: space
\citep[e.g.,][]{shin-etal2009, bagherbandi-eshagh2012, barzaghi-biagi2014, 
sampietro2015, uieda-barbosa2017} and in the Fourier domain 
% scale: regional | data: gravity | domain: Fourier
\citep[e.g.,][]{braitenberg-etal1997, braitenberg-zadro1999, vandermeijde-etal2013}.
Finally, there is a small group of methods estimating the geometry of multiple surfaces 
\citep[e.g.,][]{braitenberg-etal2003, camacho-etal2011, salem-etal2014, ferderer-etal2017, 
garcia-abdeslem2017, salem2017}.

All these methods suffer from the inherent ambiguity \citep{skeels1947, roy1962} in
determining the true physical property distribution that produces a discrete set of
observed gravity data. 
It is well known that, by presuming a fixed density distribution for each layer,
it is possible to find different surfaces producing the same gravity data. 
It is known that methods estimating multiple surfaces suffer from a 
greater ambiguity if compared with those estimating the geometry of a single surface.
This inherent ambiguity is drastically increased for the cases in which, besides the
geometry of the surfaces, the density distribution of the layers are also estimated.
To partially overcome the ambiguity and generate meaningful solutions, the interpreter
must use a priori information obtained from seismic data and/or boreholes in
order to constrain the range of possible models.
Some authors opted for combining gravity data with seismic and isostasy 
to reduce this inherent ambiguity.
As properly pointed out by \citet{gradmann-etal2017}, isostasy is equally 
sensitive to shallow and deep structures. This characteristic makes it a
powerful tool to validate interpretations of deep seismic data and gravity models.

\citet{condi-etal1999} proposed a nonlinear gravity inversion for estimating the
offshore deep structures of a rifted margin.
Their method uses local isostasy for directly constraining the 
geometries of the shallow and deeper parts of their model, without necessarily
forcing it to be in a perfect isostatic equilibrium.
\citet{braitenberg-etal2003} proposed a method for estimating the 
bathymetry and Moho geometries from gravity data by imposing regional isostatic
equilibrium in the frame of the thin-plate isostatic flexure model over an
oceanic basin.
\citet{salem-etal2014} presented a non-linear gravity inversion for estimating the 
surfaces representing basement and Moho on an onshore rifted basin. 
The basement relief is estimated by using an iterative approach similar to that
presented by \citet{bott1960} and \citet{cordell-henderson1968}. 
The difference is that, at each iteration, the Airy-Heiskanen model
\citep[][$\,$ p. 135]{heiskanen-moritz1967} for local isostatic equilibrium is used 
to subsequently update the Moho geometry, forcing the model to be in
perfect isostatic equilibrium according to the Airy-Heiskanen model.
Notice that their method does not estimate the geometries of basement and Moho 
simultaneously.
As properly pointed out by \citet{silva-etal2014}, \citeauthor{bott1960}'s
method does not define optimal step sizes at the iterative corrections,
does not impose constraints for obtaining stable solutions, nor use
an objective stopping criterion. 
Consequently, the method presented by \citet{salem-etal2014} is also susceptible 
to these limitations.
\citet{garcia-abdeslem2017} uses an approach based on flexural isostasy 
to estimate the Moho and compute a regional gravity field, which is subsequently 
subtracted from the observed gravity data to obtain a residual gravity field. 
His method consists in solving a non-linear inverse problem for estimating the
basement geometry explaining the residual gravity field.
\citet{salem2017} presents a general framework for estimating the surfaces 
associated with basement and Moho on a rifted continental margin.
His method is based on an empirical logistic function that acts as a gain 
control of the Moho uplift and introduces information about isostatic equilibrium 
by correlating the gravity data produced by the basement and Moho.
Similarly to \citet{salem-etal2014} and \citet{garcia-abdeslem2017}, the method presented
by \citet{salem2017} does not estimate the surfaces of basement and Moho simultaneously.
The Moho surface is estimated in a first step and then used to estimate the basement surface.
\citet{ferderer-etal2017} proposed a ``general local isostasy" approach, which consists
in combining the Airy-Heiskanen and Pratt-Hayford models \citep{heiskanen-moritz1967} 
so that the crust density and geometry may vary laterally in order to maintain the local 
isostatic equilibrium on a profile crossing a rifted margin. Their approach also uses local isostasy 
to directly link the geometries of shallow and deeper structures with the purpose of reducing the 
range of possible solutions.
They propose a method for estimating the geometries of basement and Moho and density contrasts by
using a grid-search technique \citep{sen-stoffa2013}.
Such techniques involve the systematic search for model parameters producing the best data fit
and may be far from being practical in geophysical applications for the cases in which
the model space is very large and the forward problem is slow.

We present a non-linear gravity inversion method for simultaneously estimating the 
geometries of basement and Moho, as well as a constant depth representing a reference 
Moho along a profile crossing a rifted margin.
Our method is formulated, in the space domain, as a non-linear gravity inversion
based on the Levenberg-Marquardt method \citep{silva-etal2001, aster-etal2005}, 
by following the same strategy of \citet{barbosa-etal1999} to incorporate
inequality constraints.
The parameters to be estimated are the constant depth representing the
reference Moho and the geometries of basement and Moho.
At each iteration, our method simultaneously estimates corrections for the 
reference Moho, as well as the geometries of basement and Moho. 
In order to produce stable solutions, we use different constraints imposing 
smoothness on basement and Moho surfaces. Additionally, we force them to be 
close to some depths along the profile. 

Similarly to \citet{ferderer-etal2017}, we combine the Airy-Heiskanen and Pratt-Hayford
models to impose local isostatic equilibrium. However, there are three significant differences
between our approach and those presented in earlier studies.
The first one is the way we impose isostatic equilibrium. Differently from previous 
methods, we do not use local isostasy to directly link the geometries of basement and Moho.
Rather, we impose smoothness on the lithostatic stress exerted by the interpretation 
model on a constant compensation depth, below which there are no lateral density variations.
This information is directionally consistent with the basic principle of 
local isostatic equilibrium according to the Airy-Heiskanen and Pratt-Hayford models.
Our constraint introduces the information that the lithostatic stress must be mostly 
smooth along the entire profile, except at some regions, where it can present abrupt
variations. At these locations, our method enables the estimated model to deviate from the 
local isostatic equilibrium. 
This is particularly useful for delimiting regions that conform to and deviate
from the isostatic equilibrium along the profile.
The second aspect by which our approach differs from those in the literature
is that it allows the interpreter to control how much the 
estimated models can deviate from the isostatic equilibrium.
As a consequence, the interpreter can obtain a set of candidate models 
that (i) fit the observed data and (ii) present different degrees of isostatic 
equilibrium.
Finally, it is worth noting that, in contrast to most of earlier studies, our method 
attempts to use isostasy for exploring (and not necessarily reducing) the inherent 
ambiguity of gravity methods.

Tests with synthetic data show the good performance of our method in simultaneously
retrieving the geometry of basement and Moho of a realistic margin model,
which is based on a seismic profile crossing the East Greenland margin,
over the Jameson Land basin \citep{peron-etal2013}, and shows an extreme crustal thinning.
We also applied our method to invert gravity data on a profile over the Pelotas basin 
\citep{stica-etal2014}. This basin is located at the offshore southern of Brazil and is 
considered a classical example of volcanic passive margin \citep{geoffroy2005}. 
We inverted gravity data provided by the combined global gravity field model EIGEN-6C4
\citep{forste2014}, one of the latest releases of the ``European Improved Gravity model of 
the Earth by New techniques" series.
Our results are consistent with the models presented by \citet{stica-etal2014} and
\citet{zalan2015}, who combined seismic, gravity and magnetic data.
These results show that, combined with a priori information, simple isostatic models 
can be helpful in investigating continental margins, specially at regions presenting pronounced 
crustal thinning.


\section{Methodology}


\subsection{Forward problem}


Let $\mathbf{d}^{o}$ be the observed data vector, whose $i$-th element $d^{o}_{i}$, 
$i = 1, \dots, N$, represents the observed gravity disturbance \citep{heiskanen-moritz1967} 
at the point $(x_{i}, y_{i}, z_{i})$, on a profile located over a rifted passive margin. 
The coordinates are referred to a topocentric Cartesian system, with $z$-axis pointing
downward, $y$-axis along the profile and $x$-axis perpendicular to the profile. 
In local- and regional-scale studies, the gravity disturbance 
represents the vertical component of the gravitational attraction exerted by the gravity 
sources. It is more appropriated for geophysical applications,
numerically similar to the classical free-air anomaly and uses the height relative to the
reference ellipsoid (geometric height) instead of the Geoid (orthometric height)
\citep{li2001, fairhead2003, hackney-featherstone2003, hinze2005, vajda-etal2006, 
vajda-etal2007}.

The density distribution in a rifted margin can be very complex.
In volcanic margins, for example, the crust may consist partially or wholly of 
food-basalts and tuffs, which are commonly imaged as Seaward Dipping Reflectors (SDR).
Underneath this intruded crust, high-velocity seismic zones are usually interpreted 
as bodies of underplated mafic to ultra-mafic magma \citep{geoffroy2005}.
We assume that the actual mass distribution in a rifted passive margin can be 
schematically represented according to Figure~\ref{fig:rifted-margin-model}. 
In this model, the subsurface is formed by four layers. 
Layer 1 is the shallowest and represents a water layer with constant density
$\rho^{(w)}$. 
Layer 2 is formed by $Q$ vertically adjacent sub-layers representing 
sediments, salt or volcanic rocks.
In our example, this layer is formed by two sub-layers with constant densities
$\rho^{(q)}$, $q = 1, 2$. Different models can be created by changing the number $Q$
according to the complexity of the study area and available a priori information.
In many cases, seismic data can be used to constrain the geometry of these 
shallow structures.
Layer 3 represents the crust and we presume that its density $\rho^{(c)}$
varies horizontally along the profile, according to a predefined function.
In Figure \ref{fig:rifted-margin-model}, we consider that crust density assumes 
two possible values. It can be equal to $\rho^{(cc)}$, which
represents the continental crust, or equal to $\rho^{(oc)}$, which represents the
oceanic crust.
However, more complex functions representing the crust density distribution can be
specified according to interpreter's knowledge about the geology at study area.
This approach presumes that bulk values can be used 
to approximate the real density distribution at the deeper parts of crust. 
Finally, Layer 4 represents a homogeneous mantle with constant density $\rho^{(m)}$. 
The surface separating the Layers 2 and 3 defines the basement relief whereas
that separating Layers 3 and 4 defines the Moho. These surfaces are
represented as dashed-white lines in Figure~\ref{fig:rifted-margin-model}.
%We also presume the existence of an compensation depth at $S_{0}$ 
%(continuous black line in Figure~\ref{fig:rifted-margin-model}),
%below which there is no lateral density variations.

In order to define the anomalous mass distribution producing the observed gravity
disturbance, we presume a reference mass distribution formed by two 
layers. The shallowest represents a homogeneous crust with constant
density $\rho^{(r)}$. Its thickness is defined by a surface conveniently 
called \textit{reference Moho} (Figures~\ref{fig:rifted-margin-model} 
and \ref{fig:interpretation-model}).
The deepest layer in the reference mass distribution represents a homogeneous mantle
with constant density $\rho^{(m)}$. Notice that the mantle in the reference mass 
distribution has the same density as the mantle in our rifted margin model
(Figure~\ref{fig:rifted-margin-model}).
The reference model can be thought of as the outer layers of a concentric
mass distribution producing the normal gravity field.
In a local scale, this concentric mass distribution is close to a 
stack of two Bouguer slabs.

We consider that the anomalous mass distribution producing the observed data
is defined as the difference between the rifted margin model 
and the reference mass distribution (Figure~\ref{fig:rifted-margin-model}).
As a consequence, the anomalous mass distribution is characterized by regions
with constant density contrasts.
This anomalous distribution is approximated by an interpretation model 
formed by $N$ columns of vertically stacked prisms 
(Figure~\ref{fig:interpretation-model}).
For convenience, we presume that there is an observed gravity disturbance over the
center of each column.
We consider that the prisms in the extremities of the interpretation model extend to
infinity along the $y$-axis in order to prevent edge effects in the forward 
calculations. 
The $i$-th column is formed by vertically stacked prisms having infinite length along 
the $x$-axis and locally approximates the four layers of our rifted margin model
(Figure~\ref{fig:rifted-margin-model}).

Layer 1 is defined by a single prism, has thickness $t^{(w)}_{i}$ and a constant density
contrast $\Delta \rho^{(w)} = \rho^{(w)} - \rho^{(r)}$.
Layer 2 is defined by the interpreter, according to the complexity of the study area 
and the available a priori information, by a set of $Q$ vertically stacked
prisms, each one with thickness $t^{(q)}_{i}$ and constant density contrast
$\Delta \rho^{(q)} = \rho^{(q)} - \rho^{(r)}$, $q = 1, \dots Q$.
Layer 3 represents the deeper part of the crust, it is also formed by a single prism,
has thickness $t^{(c)}_{i}$ and density contrast 
$\Delta \rho^{(c)}_{i} = \rho^{(c)}_{i} - \rho^{(r)}$, 
with $\rho^{(c)}_{i}$ being the crust density at the coordinate
$y_{i}$, $i = 1, \dots, N$, along the profile.
According to Figure~\ref{fig:interpretation-model}, the crust density contrast
$\Delta \rho^{(c)}_{i}$ may assume two possible values, depending on its position
with respect to the coordinate $y_{COT}$ of the Crust-Ocean Transition (COT).
More complex models can be set by the interpreter according to the available
a priori information at the study area.
The top and bottom of this layer define, respectively, the basement and Moho. 
Finally, Layer 4 representing the mantle is divided into two sub-layers, each one formed
by a single prism having the same constant density contrast 
$\Delta \rho^{(m)} = \rho^{(m)} - \rho^{(r)}$. The shallowest sub-layer 
has thickness $t^{(m)}_{i}$. Its top and bottom define,
respectively, the depths of Moho and the compensation depth $S_{0}$.
The deepest sub-layer has thickness $\Delta S$, top at $S_{0}$ and bottom at 
$S_{0} + \Delta S$, which defines the reference Moho. 

Given the density contrasts, the COT position $y_{COT}$, the compensation
depth $S_{0}$, the thickness $t^{(w)}_{i}$ of the prisms defining Layer 1 and 
also the thickness $t^{(q)}_{i}$, $i = 1 \dots, N$, of the prisms forming the 
upper $Q-1$ sub-layers of Layer 2, it is possible to describe the interpretation
model in terms of an $M \times 1$ parameter vector $\mathbf{p}$, $M = 2N + 1$, defined
as follows:
\begin{equation}
\mathbf{p} = \begin{bmatrix}
\mathbf{t}^{(Q)} \\
\mathbf{t}^{(m)} \\
\Delta S
\end{bmatrix} \: ,
\label{eq:parameter-vector}
\end{equation}
where $\mathbf{t}^{(Q)}$ and $\mathbf{t}^{(m)}$ are $N \times 1$ vectors whose $i$-th
elements $t^{(Q)}_{i}$ and $t^{(m)}_{i}$ (Figure~\ref{fig:interpretation-model}) 
represent the thickness of the
prisms forming, respectively, the base of Layer 2 and the top of Layer 4.
Notice that $t^{(Q)}_{i}$ and $t^{(m)}_{i}$, $i = 1, \dots, N$, approximate, respectively, the 
geometries of basement and Moho and $\Delta S$ defines the depth of the
reference Moho (Figure~\ref{fig:interpretation-model}).
In this case, the gravity disturbance produced by the interpretation model (the
predicted gravity disturbance) at the position $(x_{i}, y_{i}, z_{i})$ can be written
as the sum of the vertical component of the gravitational attraction exerted by the $L$
prisms forming the interpretation model as follows:
\begin{equation}
d_{i}(\mathbf{p}) = k_{g} \, G \, \sum_{j = 1}^{L} f_{ij}(\mathbf{p}) \: ,
\label{eq:ith-predicted-data}
\end{equation}
where $f_{ij}(\mathbf{p})$ represents an integral over the volume of the $j$-th 
prism. Here, these volume integrals are computed with the expressions proposed 
by \citet{nagy-etal2000}, by using the open-source Python package 
\textit{Fatiando a Terra} \citep{uieda-etal2013}.


\subsection{Inverse problem formulation}


Let $\mathbf{d}(\mathbf{p})$ be the predicted data vector, whose $i$-th element
$d_{i}(\mathbf{p})$ is the vertical component of the gravitational attraction
(equation~\ref{eq:ith-predicted-data}) exerted by the interpretation model
at the position $(x_{i}, y_{i}, z_{i})$ on the profile.
We estimate a particular parameter vector producing a predicted data
$\mathbf{d}(\mathbf{p})$ as close as possible to the observed data 
$\mathbf{d}^{o}$ by minimizing the goal function
\begin{equation}
\Gamma (\mathbf{p}) = \Phi(\mathbf{p}) + \sum_{\ell = 0}^{4} \mu_{\ell}
\Psi_{\ell}(\mathbf{p}) \: ,
\label{eq:goal-function}
\end{equation}
subject to the inequality constraint 
\begin{equation}
p_{j}^{min} < p_{j} < p_{j}^{max} \: , \quad j = 1, \dots, M \: ,
\label{eq:inequality-constraint}
\end{equation}
where $p_{j}^{min}$ and $p_{j}^{max}$ define, respectively, lower and upper bounds 
for the $j$-th element of $\mathbf{p}$.
In equation~\ref{eq:goal-function}, $\mu_{\ell}$ is the weight assigned to the 
$\ell$-th regularizing function $\Psi_{\ell}(\mathbf{p})$, $\ell = 0, \dots, 4$, and
$\Phi(\mathbf{p})$ is the misfit function given by
\begin{equation}
\Phi(\mathbf{p}) = \frac{1}{N} \| \mathbf{d}^{o} - \mathbf{d}(\mathbf{p}) \|_{2}^{2} 
\: , 
\label{eq:misfit-function}
\end{equation}
where $\| \cdot \|_{2}^{2}$ represents the squared Euclidean norm. 
Notice that our method estimates the parameter vector $\mathbf{p}$ 
(equation~\ref{eq:parameter-vector}), which contains the geometries of 
basement and Moho, as well as the thickness $\Delta S$ defining
the depth of the reference Moho (Figure~\ref{fig:interpretation-model}).
The bottom of Layer 1 is defined by the available bathymetry. The geometry of the 
upper sub-layers forming Layer 2 and the constant compensation depth $S_{0}$ 
(Figure~\ref{fig:interpretation-model}) are defined by using the available a 
priori information.
These predefined quantities remain fixed during the inversion.
Details about the regularizing functions $\Psi_{\ell}(\mathbf{p})$, $\ell = 0, \dots, 4$ 
and the numerical procedure to solve this non-linear inverse problem are given in the 
following sections.


\subsection{Isostatic constraint}

Consider that no vertical forces are acting on the lateral surfaces of 
each column forming the model (Figure \ref{fig:interpretation-model}). In this case, 
the lithostatic stress (pressure) $\tau_{i}$ (in MPa) exerted by the $i$-th column at 
the surface $S_{0}$ can be computed according to the Archimedes' principle as follows
\citep[][ p. 129]{turcotte-schubert2002}:
\begin{equation}
t^{(w)}_{i} \rho^{(w)} + t^{(1)}_{i} \rho^{(1)}_{i} + \dots + 
t^{(Q)}_{i} \rho^{(Q)}_{i} + t^{(c)}_{i} \rho^{(c)}_{i} + t^{(m)}_{i} \rho^{(m)} 
= \tau_{i} \: g_{m}^{-1} \: ,
\label{eq:lithostatic-stress-densities}
\end{equation}
where $g_{m}$ is the mean gravity value on the study area. 
We consider this mean value equal to $9.81$ m/s$^{2}$ along the profile.
By rearranging terms in equation~\ref{eq:lithostatic-stress-densities} 
and using the relation
\begin{equation}
S_{0} = t^{(w)}_{i} + t^{(1)}_{i} + \dots + t^{(Q)}_{i} + t^{(c)}_{i} + t^{(m)}_{i} \: ,
\label{eq:S0}
\end{equation}
it is possible to show that:
\begin{equation}
\Delta \tilde{\rho}^{(Q)}_{i} \, t^{(Q)}_{i} + 
\Delta \tilde{\rho}^{(m)}_{i} \, t^{(m)}_{i} + 
\Delta \tilde{\rho}^{(w)}_{i} \, t^{(w)}_{i} + 
\Delta \tilde{\rho}^{(1)}_{i} \, t^{(1)}_{i} +
\dots + 
\Delta \tilde{\rho}^{(Q-1)}_{i} \, t^{(Q-1)}_{i} +
\rho^{(c)}_{i} \, S_{0} = \tau_{i} \: g_{m}^{-1} \: ,
\label{eq:lithostatic-stress-density-contrasts}
\end{equation}
where $\Delta \tilde{\rho}^{(\alpha)}_{i} = \rho^{(\alpha)}_{i} - \rho^{(c)}_{i}$, 
$\alpha = w, 1, \dots, Q-1, Q, m$.
In order to describe the lithostatic stress exerted by all columns forming the
interpretation model on the surface $S_{0}$, 
equation~\ref{eq:lithostatic-stress-density-contrasts} 
can be written as follows:
\begin{equation}
\mathbf{M}^{(Q)} \mathbf{t}^{(Q)} + \mathbf{M}^{(m)} \mathbf{t}^{(m)} + \mathbf{M}^{(w)}
\mathbf{t}^{(w)} + \mathbf{M}^{(1)} \mathbf{t}^{(1)} + \dots + \mathbf{M}^{(Q-1)}
\mathbf{t}^{(Q-1)} + \boldsymbol{\rho}^{(c)} S_{0} = g_{m}^{-1} \: \boldsymbol{\tau} \: ,
\label{eq:lithostatic-stress-matrix}
\end{equation}
where $\boldsymbol{\tau}$ is an $N \times 1$ vector whose $i$-th element is
the $\tau_{i}$ (equation~\ref{eq:lithostatic-stress-densities}) associated with
the $i$-th column; $\mathbf{t}^{(\alpha)}$, $\alpha = w, 1, \dots, Q-1, Q, m$, 
is an $N \times 1$ vector with $i$-th element defined by the thickness 
$t^{(\alpha)}_{i}$ of a prism in the $i$-th column; $\mathbf{M}^{(\alpha)}$ is an $N \times N$ diagonal 
matrix whose elements are defined by the density contrasts 
$\Delta \tilde{\rho}^{(\alpha)}_{i}$, $i = 1, \dots, N$, of the prisms in a layer and
$\boldsymbol{\rho}^{(c)}$ is an $N \times 1$ vector containing the densities of the prisms
representing the crust. The term $g_{m}^{-1} \: \boldsymbol{\tau}$ describing the
lithostatic stress exerted by all prisms on $S_{0}$ is conveniently called
\textit{lithostatic stress curve}.

Let us now use an approach similar to that presented by \citet{ferderer-etal2017}
to combine the Airy-Heiskanen and Pratt-Hayford models \citep{heiskanen-moritz1967} 
in order to impose local isostatic equilibrium.
We impose this condition by varying both density and geometry of the crust along the 
rifted margin.
In this case, the lithostatic stress exerted by the interpretation model
must be constant at the compensation depth $S_{0}$
(Figure \ref{fig:interpretation-model}).
Differently from previous approaches in literature, we impose isostatic equilibrium 
by forcing the lithostatic stress to be smooth at $S_{0}$.
We apply the first-order Tikhonov regularization
\citep{aster-etal2005} to the lithostatic stress curve $g_{m}^{-1} \: \boldsymbol{\tau}$
(equation~\ref{eq:lithostatic-stress-matrix}), obtaining the
following expression:
\begin{equation}
\mathbf{R} \left( \mathbf{C} \mathbf{p} + \mathbf{D} \mathbf{t} \right) = \mathbf{0} 
\: ,
\label{eq:tik1-lithostatic-stress}
\end{equation}
where $\mathbf{0}$ is a vector with null elements and the remaining terms are given by:
\begin{equation}
\mathbf{C} = \begin{bmatrix}
\mathbf{M}^{(Q)} & \mathbf{M}^{(m)} & \mathbf{0}
\end{bmatrix}_{N \times M} \: ,
\label{eq:matrix-C}
\end{equation}
\begin{equation}
\mathbf{D} = \begin{bmatrix}
\mathbf{M}^{(w)} & \mathbf{M}^{(1)} & \cdots & \mathbf{M}^{(Q-1)} &
\boldsymbol{\rho}^{(c)}
\end{bmatrix}_{N \times \left( QN + 1 \right)} \: ,
\label{eq:matrix-D}
\end{equation}
\begin{equation}
\mathbf{t} = \begin{bmatrix}
\mathbf{t}^{(w)} \\ \mathbf{t}^{(1)} \\ \vdots \\ \mathbf{t}^{(Q-1)} \\ S_{0}
\end{bmatrix}_{\left( QN + 1 \right) \times 1}\: ,
\label{eq:vector-t}
\end{equation}
and $\mathbf{R}$ is an $\left( N-1 \right) \times N$ matrix, whose element 
$ij$ is defined as follows:
\begin{equation}
\left[ \mathbf{R} \right]_{ij} = \begin{cases}
1 &, \quad j = i \\
-1 &, \quad j = i + 1 \\
0 &, \quad \text{otherwise}
\end{cases} \quad .
\label{eq:matrix-R}
\end{equation}
Finally, from equation~\ref{eq:tik1-lithostatic-stress}, it is possible to
define the regularizing function $\Psi_{0}(\mathbf{p})$ 
(equation~\ref{eq:goal-function}): 
\begin{equation}
\Psi_{0}(\mathbf{p}) = \| \mathbf{W} \, \mathbf{R} \left( \mathbf{C} \mathbf{p} + \mathbf{D}
\mathbf{t} \right) \|_{2}^{2} \: ,
\label{eq:isostatic-constraint-function}
\end{equation}
where $\mathbf{W}$ is an $(N - 1) \times (N - 1)$ diagonal matrix having constant
elements $0 < w_{ii} \le 1$, $i = 1, \dots, N - 1$. 
Function $\Psi_{0}(\mathbf{p})$ defines the \textit{Isostatic constraint}.

Notice that, by minimizing the function $\Psi_{0}(\mathbf{p})$ 
(equation~\ref{eq:isostatic-constraint-function}), the method imposes smoothness on 
the lithostatic stress exerted by the interpretation model on the 
compensation depth $S_{0}$.
Matrix $\mathbf{W}$ controls the relative amount of isostatic equilibrium imposed 
along the profile. 
In the particular case in which all diagonal elements $w_{ii}$ have the same
constant value, the same amount of isostatic equilibrium is imposed along the 
whole profile. On the other hand, different amounts of isostatic equilibrium
can be imposed along the profile by varying the values of these elements.
Elements $w_{ii} \approx 1$ impose a smooth lithostatic stress curve 
at the transition between columns $i$ and $i+1$ of the interpretation model.
Elements $w_{ii} \approx 0$ allow abrupt variations in the lithostatic stress 
curve between columns $i$ and $i+1$ of the interpretation model.
By using all elements $w_{ii} = 1$, we impose full isostatic equilibrium 
along the entire profile. Alternatively, we may enable the interpretation model 
to deviate from the isostatic equilibrium by conveniently decreasing the numerical values
assigned to the elements $w_{ii}$ at specific regions along the profile. 
The strategy used to define the elements $w_{ii}$ is 
presented in the specific section describing the computational procedures
for solving the inverse problem.


\subsection{Smoothness constraints}


These constraints impose smoothness on the adjacent thickness of the prisms defining
the geometries of basement (base of Layer 2) and Moho (top of Layer 4). 
This information is introduced by applying the first-order Tikhonov regularization
\citep{aster-etal2005} to the vectors $\mathbf{t}^{(Q)}$ and $\mathbf{t}^{(m)}$ 
(equation~\ref{eq:parameter-vector}). 
Mathematically, these constraints are represented by the regularizing functions
$\Psi_{1}(\mathbf{p})$ and $\Psi_{2}(\mathbf{p})$ (equation~\ref{eq:goal-function}),
which are given by:
\begin{equation}
\Psi_{1}(\mathbf{p}) = \| \mathbf{S}\mathbf{p} \|_{2}^{2}
\label{eq:smootheness-contraint-basement}
\end{equation}
and 
\begin{equation}
\Psi_{2}(\mathbf{p}) = \| \mathbf{T}\mathbf{p} \|_{2}^{2} \: ,
\label{eq:smootheness-contraint-moho}
\end{equation}
where $\mathbf{S}$ and $\mathbf{T}$ are matrices given by:
\begin{equation}
\mathbf{S} = \begin{bmatrix}
\mathbf{R} & \mathbf{0} & \mathbf{0}
\end{bmatrix}_{\left( N-1 \right) \times M}
\label{eq:matrix-S}
\end{equation}
and
\begin{equation}
\mathbf{T} = \begin{bmatrix}
\mathbf{0} & \mathbf{R} & \mathbf{0}
\end{bmatrix}_{\left( N-1 \right) \times M} \: .
\label{eq:matrix-T}
\end{equation}
In these equations, $\mathbf{R}$ is defined by equation~\ref{eq:matrix-R} 
and $\mathbf{0}$ are matrices with all elements equal to zero.


\subsection{Equality constraints}

In order to incorporate a priori information at isolated points on the basement
and Moho surfaces, we use an approach similar to those proposed by
\citet{barbosa-etal1997} and \citet{barbosa-etal1999b}. 

\subsubsection*{Equality constraint on vector $\mathbf{t}^{(Q)}$}

Let $\mathbf{a}$ be a vector whose $k$-th element $a_{k}$,
$k = 1, \dots, A$, is the difference between a known basement depth and
the sum of the thickness of the upper parts of the interpretation model
(water layer and the upper sub-layers of Layer 2), all at the same
horizontal coordinate $y^{A}_{k}$ of the profile. 
These differences, which must be positive, are used to define 
the regularizing function $\Psi_{2}(\mathbf{p})$ 
(equation~\ref{eq:goal-function}):
\begin{equation}
\Psi_{2}(\mathbf{p}) = \| \mathbf{A}\mathbf{p} - \mathbf{a} \|_{2}^{2} \: ,
\label{eq:equality-constraint-basement}
\end{equation}
where $\mathbf{A}$ is an $A \times M$ matrix whose $k$-th line has one element 
equal to one and all the remaining elements equal to zero. The location of the
single non-null element in the $k$-th line of $\mathbf{A}$ depends on the coordinate
$y^{A}_{k}$ of the known thickness $a_{k}$. Let us consider, 
for example, an interpretation model formed by $N = 10$ columns. Consider also that 
the thickness of the deepest sub-layer of Layer 2  
at the coordinates $y^{A}_{1} = y_{4}$ and $y^{A}_{2} = y_{9}$ 
are equal to $25$ and $35.7$ km, respectively. In this case, $A = 2$,
$\mathbf{a}$ is a $2 \times 1$ vector with elements $a_{1} = 25$ and $a_{2} = 35.7$
and $\mathbf{A}$ is a $2 \times M$ matrix ($M = 2N + 1 = 21$). The element $4$ of the
first line and the element $9$ of the second line of $\mathbf{A}$ are equal to $1$ and
all its remaining elements are equal to zero.

\subsubsection*{Equality constraint on vector $\mathbf{t}^{(m)}$}

Let $\mathbf{b}$ be a vector whose $k$-th element $b_{k}$,
$k = 1, \dots, B$, is the difference between the compensation depth
$S_{0}$ and the known Moho depth at the horizontal coordinate $y^{B}_{k}$ of the
profile. These differences, which must be positive, define known thickness values
of the upper part of Layer 4. These values are used to define the 
regularizing function $\Psi_{3}(\mathbf{p})$ (equation~\ref{eq:goal-function}):
\begin{equation}
\Psi_{3}(\mathbf{p}) = \| \mathbf{B}\mathbf{p} - \mathbf{b} \|_{2}^{2} \: ,
\label{eq:equality-constraint-moho}
\end{equation}
where $\mathbf{B}$ is a $B \times M$ matrix whose $k$-th line has one element 
equal to one and all the remaining elements equal to zero. This matrix is defined 
in the same way as matrix $\mathbf{A}$ (equation~\ref{eq:equality-constraint-basement}).


\subsection{Computational procedures for solving of the inverse problem}

The parameter vector $\mathbf{p}$ (equation~\ref{eq:parameter-vector}) minimizing the
goal function $\Gamma (\mathbf{p})$ (equation~\ref{eq:goal-function}), subjected to
the inequality constraint (equation~\ref{eq:inequality-constraint}), is estimated 
in three steps (Step 1, Step 2 and Step 3 described in the following subsections). 
At each step, the goal function is minimized by using the Levenberg-Marquardt 
method \citep{silva-etal2001, aster-etal2005} and the inequality constraint 
(equation~\ref{eq:inequality-constraint}) is incorporated by using the same strategy 
employed by \citet{barbosa-etal1999}.
All derivatives of the misfit function $\Phi(\mathbf{p})$ (equation~\ref{eq:misfit-function})
with respect to the parameters are computed by using a finite difference approximation.

\subsubsection{Considerations about the weights $\mu_{0}$, $\mu_{1}$, $\mu_{2}$, $\mu_{3}$ and $\mu_{4}$}

An important aspect of our method is related to the values attributed to 
the weights $\mu_{\ell}$ (equation~\ref{eq:goal-function}).
Their values can be very dependent on the particular characteristics of the 
interpretation model and there is no analytical rule to define them. 
To overcome this problem, we normalize the $\mu_{\ell}$ values as follows:
\begin{equation}
	\mu_{\ell} = \tilde{\mu}_{\ell} \, \frac{E_{\Phi}}{E_{\ell}} \: 
	, \quad \ell = 0, \dots, 4 \: ,
	\label{eq:constraint-weights}
\end{equation}
where $\tilde{\mu}_{\ell}$ is a positive scalar and $E_{\Phi} / E_{\ell}$
is a normalizing constant. In this equation, $E_{\ell}$ represents the median 
of the elements forming the main diagonal of the Hessian matrix of the 
$\ell$-th constraining function $\Psi_{\ell}(\mathbf{p})$ 
(equations~\ref{eq:isostatic-constraint-function}, 
\ref{eq:smootheness-contraint-basement}, \ref{eq:smootheness-contraint-moho}, 
\ref{eq:equality-constraint-basement} and 
\ref{eq:equality-constraint-moho}). The constant $E_{\Phi}$ is defined in 
a similar way by using the Hessian matrix of the misfit function $\Phi(\mathbf{p})$ 
(equation~\ref{eq:misfit-function}) computed with 
the initial approximation $\mathbf{p}^{(0)}$ for the parameter vector $\mathbf{p}$ 
(equation~\ref{eq:parameter-vector}) at the Step 1 (described in the following subsection).
According to this empirical strategy, the weights $\mu_{\ell}$ are defined 
by using the positive scalars $\tilde{\mu}_{\ell}$ 
(equation \ref{eq:constraint-weights}), which are less dependent on the particular 
characteristics of the interpretation model.

\subsubsection{Step 1}

This step is represented in blue at the flow diagram shown in 
Figure~\ref{fig:flow-diagram}.
It consists in solving the inverse problem without imposing 
the isostatic constraint, by using $\tilde{\mu}_{0} = 0$ 
(equation~\ref{eq:constraint-weights}). 
At this step, the interpreter must set:
\begin{itemize}
	\item \underline{Parameters defining the interpretation model
	(Figure~\ref{fig:interpretation-model}):} density contrasts $\Delta \rho^{(\alpha)}$, 
	$\alpha = w, 1, \dots, Q, cc, oc, m$, COT position $y_{COT}$, thickness $t^{(w)}_{i}$ 
	of the prisms defining Layer 1, thickness $t^{(q)}_{i}$, $i = 1 \dots, N$, of the prisms
	forming the upper $Q-1$ sub-layers of Layer 2 and isostatic compensation depth $S_{0}$. 
	Figure \ref{fig:interpretation-model} illustrates 
	the case in which the second layer is formed by $Q = 2$ parts. This number, however, 
	can be changed according to the study area.
	\item \underline{Parameters for the inversion:} weights $\tilde{\mu}_{\ell}$,
	$\ell = 1, \dots, 4$ (equation~\ref{eq:constraint-weights}), associated to the 
	smoothness and equality constraints (equations 
	\ref{eq:smootheness-contraint-basement}, \ref{eq:smootheness-contraint-moho},
	\ref{eq:equality-constraint-basement} and \ref{eq:equality-constraint-moho}),
	lower and upper bounds $p_{j}^{min}$ and $p_{j}^{max}$
	(equation~\ref{eq:inequality-constraint}), $j = 1, \dots, M$,
	for the parameters to be estimated, vectors $\mathbf{a}$ 
	(equation~\ref{eq:equality-constraint-basement}) and $\mathbf{b}$
	(equation~\ref{eq:equality-constraint-moho}) containing known thickness values
	and an initial approximation $\mathbf{p}^{(0)}$ for the parameter vector $\mathbf{p}$
	(equation~\ref{eq:parameter-vector}). The initial approximation $\mathbf{p}^{(0)}$
	must satisfy the inequality constraints (equation~\ref{eq:inequality-constraint}).
\end{itemize}

The initial approximation $\mathbf{p}^{(0)}$ is used to compute the 
Hessian matrix of the misfit function $\Phi(\mathbf{p})$ (equation~\ref{eq:misfit-function}),
which is subsequently used to compute the constant $E_{\Phi}$ (equation~\ref{eq:constraint-weights}).
The estimated parameter vector obtained at the end of Step 1 is conveniently called
$\mathbf{p}^{(1)}$. The main goal in this step is finding suitable values for the parameters
defining the interpretation model and those used for inversion. Several trials may be
necessary to find suitable values for these parameters.

\subsubsection{Step 2}

Step 2 is represented in red at the flow diagram (Figure~\ref{fig:flow-diagram})
and consists in obtaining an estimated parameter vector $\mathbf{p}^{(2)}$
by imposing full isostatic equilibrium on the interpretation model along the entire profile.
In this step, the interpreter must use the same initial approximation $\mathbf{p}^{(0)}$
of Step 1.
Additionally, the interpreter must set the matrix $\mathbf{W}$
equal to the identity and find a suitable value for the weight $\tilde{\mu}_{0}$ 
(equation \ref{eq:constraint-weights}) controlling the isostatic constraint 
(equation~\ref{eq:isostatic-constraint-function}).
We presume that, by imposing full isostatic equilibrium along the entire profile,
the estimated parameter vector $\mathbf{p}^{(2)}$ will produce a mostly good data fit,
except at some isolated regions. 
We assume that, at these regions, the passive margin deviates 
from the local isostatic equilibrium.

\subsubsection{Step 3}

Step 3 represented in green at the flow diagram (Figure~\ref{fig:flow-diagram}). 
It consists in using $\mathbf{p}^{(2)}$ as initial 
approximation to obtain an estimated parameter vector $\mathbf{p}^{(3)}$
by imposing different amounts of isostatic equilibrium on the interpretation model along the
profile. At this step, the interpreter must compute the diagonal elements 
$w_{ii}$ of the matrix $\mathbf{W}$ (equation~\ref{eq:isostatic-constraint-function}) 
in order to enable the interpretation model to deviate from isostatic equilibrium in 
the regions presenting large residuals. 
The elements of $\mathbf{W}$ are computed as follows:
\begin{equation} \label{eq:elements-wii}
w_{ii} = 
\exp \left[ - \frac{ \left( r_{i}^{(2)} + r_{i+1}^{(2)} \right)^{2}}{4 \sigma} \right] \: ,
\end{equation}
where $\sigma$ is a positive constant, $\mathbf{p}^{(2)}$ is the estimated parameter vector
obtained in the previous step and the variables
$r_{i}^{(2)} = d^{o}_{i} - d_{i} \left( \mathbf{p}^{(2)} \right)$ and 
$r_{i+1}^{(2)} = d^{o}_{i+1} - d_{i+1} \left(\mathbf{p}^{(2)} \right)$ represent,
respectively, the residuals between observed and predicted data
(equation~\ref{eq:ith-predicted-data}) at the positions $(x_{i}, y_{i}, z_{i})$ and 
$(x_{i+1}, y_{i+1}, z_{i+1})$. Notice that equation~\ref{eq:elements-wii} defines elements 
$w_{ii}$ in the interval $\left] 0, 1 \right]$. Additionally, this equation results in 
$w_{ii} \approx 1$ at regions where the residuals are close to zero and 
$w_{ii} \approx 0$ at regions presenting large residuals.
The positive constant $\sigma$ controls the deviation from isostatic equilibrium.
Small $\sigma$ values allow large deviations from isostatic equilibrium,
resulting in estimated models close to that obtained at Step 1.
Large $\sigma$ values allow small deviations from isostatic equilibrium,
resulting in estimated models close to that obtained at Step 2.
This strategy to define the elements of matrix $\mathbf{W}$ 
(equation~\ref{eq:isostatic-constraint-function}) presumes that the isostatic constraint may
produce large residuals at some regions along the profile. To counteract this problem,
our method enables the interpretation model to deviate from isostatic equilibrium at these 
regions. This idea is in agreement with the fact that isostatic equilibrium at 
passive rifted margin cannot be totally explained by local models.

\subsubsection*{Practical considerations}

Our algorithm depends on several parameters that significantly impact the estimated models
and cannot be automatically set without the interpreter’s judgment.
They are the parameters $\tilde{\mu}_{1}$, $\tilde{\mu}_{2}$, $\tilde{\mu}_{3}$ 
and $\tilde{\mu}_{4}$ (Step 1), $\tilde{\mu}_{0}$ (Step 2) and $\sigma$ (Step 3).
Based on our practical experience, we suggest some empirical procedures for setting these
parameters at each step. They are schematically represented at the flow diagram 
(Figure~\ref{fig:flow-diagram}).

At Step 1, set $\tilde{\mu}_{1} = \tilde{\mu}_{2} = 0$ and try different positive 
values for $\tilde{\mu}_{3}$ and $\tilde{\mu}_{4}$. 
These two parameters control the equality constraints
(equations~\ref{eq:equality-constraint-basement} and \ref{eq:equality-constraint-moho})
imposing a priori information at isolated points on the basement and Moho surfaces.
Good guesses are, respectively,
$10^{1}$ and $10^{2}$. Normally, $\tilde{\mu}_{4}$ is one order of magnitude greater
than $\tilde{\mu}_{3}$. 
The parameters $\tilde{\mu}_{3}$ and $\tilde{\mu}_{4}$ 
must be the smallest positive numbers resulting in an estimated model $\mathbf{p}^{\prime}$ 
with basement and Moho surfaces close to the values provided by the a priori information
at some isolated points. Notice that $\mathbf{p}^{\prime}$ is an intermediate model 
obtained by using only the equality constraints. Consequently, there must be some
pinnacles in the estimated models, around the points associated with the a priori 
information. This effect has already been observed by \citet{barbosa-etal1997}.
The acceptability criterion described above to define the values of $\tilde{\mu}_{3}$ and 
$\tilde{\mu}_{4}$ is represented by the decision point $D(\tilde{\mu}_{3}, \tilde{\mu}_{4})$ 
at the flow diagram (Figure~\ref{fig:flow-diagram}).

By using the chosen values for $\tilde{\mu}_{3}$ and $\tilde{\mu}_{4}$, 
try different positive values for $\tilde{\mu}_{1}$ and $\tilde{\mu}_{2}$.
These parameters control the smoothness of basement and Moho surfaces
(equations~\ref{eq:smootheness-contraint-basement} and \ref{eq:smootheness-contraint-moho}).
Usually, $\tilde{\mu}_{2}$ is one order of magnitude greater than $\tilde{\mu}_{1}$.
Good guesses are $10^{1}$ and $10^{2}$.
These parameters must be the smallest positive numbers producing an estimated model
satisfying the following conditions: (i) the data fit must be good along the entire profile
and (ii) the pinnacles must be completely removed or attenuated as much as possible.
This acceptability criterion to define the values of $\tilde{\mu}_{1}$ and 
$\tilde{\mu}_{2}$ is represented by the decision point $D(\tilde{\mu}_{1}, \tilde{\mu}_{2})$ 
at the flow diagram (Figure~\ref{fig:flow-diagram}).
Generally, the estimated lithostatic stress curve at Step 1 is close to the true one
and can be used to perform a preliminary analysis of the isostatic equilibrium along
the profile. It can be used to identify regions more close to the local isostatic equilibrium,
where the curve is relatively smooth and shows small variations, and regions that deviate
from the equilibrium and show large variations in the lithostatic stress curve.

At Step 2, try different positive values for $\tilde{\mu}_{0}$ 
(equation~\ref{eq:constraint-weights}). This parameter
controls the smoothness of the lithostatic stress exerted by the interpretation model
at the compensation depth $S_{0}$. Generally, $\tilde{\mu}_{0}$ is one or two 
orders of magnitude greater than $\tilde{\mu}_{1}$. 
Good guesses are $10^{2}$ or $10^{3}$.
This parameter must be the largest positive number resulting in an estimated
model satisfying two conditions: 
(i) the lithostatic stress curve must be smoother than that obtained at Step 1 
along the entire profile and 
(ii) there must be a good data fit along the entire
profile, except at some isolated regions that may show relatively large residuals.
This acceptability criterion for the value of $\tilde{\mu}_{0}$ is
represented by the decision point $D(\tilde{\mu}_{0})$ 
at the flow diagram (Figure~\ref{fig:flow-diagram}).
This Step shows two possible situations. The first one occurs at margins that are
more close to the local isostatic equilibrium. In this case, increasing the value of
$\tilde{\mu}_{0}$ produces remarkable deformations in the estimated model along the
entire profile without however producing large residuals between observed and predicted data.
On the other hand, at margins presenting large deviations from the local isostatic
equilibrium, the deformations produced in the basement and Moho by increasing the value of
$\tilde{\mu}_{0}$ are concentrated at the regions where the margin most deviates from 
the local isostatic equilibrium. At these regions, there are also large residuals between
the observed and predicted data.

Finally, at Step 3, try different positive values for $\sigma$ (equation~\ref{eq:elements-wii}).
This parameter controls the deviations of the interpretation model from the
isostatic equilibrium at regions presenting large residuals.
Small values produce estimated models close to that obtained at Step 1.
On the other hand, large values produce estimated models close to that
obtained at Step 2.
This parameter must be set as the largest positive number producing (i) a good data-fit
along the entire profile and (ii) an estimated model different from those obtained
at Steps 1 and 2.
This acceptability criterion to define the value of $\sigma$ is
represented by the decision point $D(\sigma)$ 
at the flow diagram (Figure~\ref{fig:flow-diagram}).
A good practice is to generate a set of estimates by using different 
values for $\sigma$. 


\section{Applications to synthetic data}


We have simulated a continental margin formed by four layers: 
water, sediments, crust (continental and oceanic) and mantle.
This model is based on a seismic profile crossing the East Greenland margin,
over the Jameson Land basin \citep{peron-etal2013}, and shows an extreme crustal thinning.
Parameters defining this model are shown in Table~\ref{tab:volcanic-margin-model}.
The density values of our model are compatible with those commonly used in literature
\citep[e.g., ][]{gradmann-etal2017}.
By following the algorithm described in the previous section, we inverted the simulated 
gravity disturbance produced by our synthetic margin.

We start with the intermediate model $\mathbf{p}^{\prime}$ (not shown) 
obtained at Step 1 (Figure~\ref{fig:flow-diagram}) by using only the equality 
constraints with parameters $\tilde{\mu}_{3} = 10^{1}$ and $\tilde{\mu}_{4} = 10^{2}$.
The remaining parameters $\tilde{\mu}_{0}$, $\tilde{\mu}_{1}$ and
$\tilde{\mu}_{2}$ are equal to zero.
The interpretation model was defined by using the parameters shown in
Table~\ref{tab:volcanic-margin-model}.
We assumed $S_{0} = 48$ km and chose an initial approximation for $\Delta S$
equal to $7$ km, which corresponds to a reference Moho deeper 
than the true one (Table~\ref{tab:volcanic-margin-model}).
The intermediate model $\mathbf{p}^{\prime}$ (not shown) contains pinnacles around 
the a priori information at the basement and Moho.
Despite the good data fit, it does not retrieve the true geometries 
of basement and Moho.

Figure~\ref{fig:synt-margin-step1} shows the estimated model $\mathbf{p}^{(1)}$ 
obtained at the end of Step 1 (Figure~\ref{fig:flow-diagram}) with
$\tilde{\mu}_{1} = 10^{1}$ and $\tilde{\mu}_{2} = 10^{2}$.
By using these values, the method was able to remove the pinnacles of 
the intermediate model (not shown).
Notice that, not only the initial approximation for the reference Moho,
but also those for basement and Moho surfaces (dashed blue lines) are very different from
the true model (continuous black lines).
As we can see, the estimated Moho and reference Moho are very close to the true ones.
On the other hand, the estimated basement is smooth and present large differences
($\approx 5$ km) relative to the true one at the region between $100$ and $150$ km,
where the model shows a pronounced crustal thinning.
Despite these large differences, 
the predicted gravity disturbance and lithostatic stress 
are very close to the simulated values.
By analyzing the predicted lithostatic stress curve, we can see that the model
can be considered in local isostatic equilibrium at the regions located before 
$75$ km and after $250$ km. As we can see, the region located
between $75$ km and $250$ km shows large variations in basement and Moho 
surfaces and also the largest deviations from the local isostatic equilibrium.

Figure~\ref{fig:synt-margin-step2} shows the estimated model $\mathbf{p}^{(2)}$ 
obtained at the end of Step 2 (Figure~\ref{fig:flow-diagram}), 
by using $\tilde{\mu}_{0} = 10^{3}$ (equation~\ref{eq:constraint-weights}).
In comparison to the estimated model $\mathbf{p}^{(1)}$ (Figure~\ref{fig:synt-margin-step1}),
this model shows a very smooth lithostatic stress curve as a consequence of the
isostatic constraint. This constraint has produced little effect on the
estimated reference Moho, resulted in a relatively worse estimated Moho and
also produced large residuals at the region between $75$ km and $250$ km.
On the other hand, it reduced the large differences between the estimated and 
true basement surfaces. The main improvement occurs at the region between  
$100$ and $150$ km, where the true model exhibits a 
pronounced crustal thinning. 
Notice that the isostatic constraint produced little effect at the regions
where the model is close to the local isostatic equilibrium 
(before $75$ km and after $250$ km).

Figures~\ref{fig:synt-margin-step3-sgm1}, \ref{fig:synt-margin-step3-sgm11} and 
\ref{fig:synt-margin-step3-sgm18} show estimated models $\mathbf{p}^{(3)}$ obtained at
the Step 3 (Figure~\ref{fig:flow-diagram}) by using different values for the parameter 
$\sigma$ (equation~\ref{eq:elements-wii}).
By comparing with estimated model $\mathbf{p}^{(2)}$
(Figure~\ref{fig:synt-margin-step2}), the new models 
show better data fits and improved estimates for Moho.
The main differences are concentrated at the regions coinciding with
large residuals and large variations in the lithostatic stress curve shown in 
Figure~\ref{fig:synt-margin-step2}.

The estimated model obtained with the smallest $\sigma$ 
(Figure~\ref{fig:synt-margin-step3-sgm1}) is close to that 
obtained at Step 1 (Figure~\ref{fig:synt-margin-step1}).
In this case, the predicted lithostatic stress curve shows large variations 
and the estimated model is far from the isostatic equilibrium.
On the other hand, the estimated model obtained with 
the largest $\sigma$ (Figure~\ref{fig:synt-margin-step3-sgm18}) is closer to 
that obtained at Step 2 (Figure~\ref{fig:synt-margin-step2}).
In this case, the predicted lithostatic stress curve is smoother than that obtained
with $\sigma = 1$ (Figure~\ref{fig:synt-margin-step3-sgm1}).
In comparison to these two models, that shown in Figure 
\ref{fig:synt-margin-step3-sgm11} exhibits an intermediate isostatic equilibrium.
Despite these differences, all of them produce a very good data fit along the 
entire profile, as well as have estimated Moho and reference Moho very close to the 
true ones. 
It is important to stress that the most significant variations produced by the 
isostatic constraint in the estimated basement and Moho are concentrated at the
central part of the profile, where the model presents large deviations from the
isostatic equilibrium. 

These results obtained with different $\sigma$ values (equation~\ref{eq:elements-wii})
show that the isostatic constraint is not able to completely
remove the ambiguity of the inverse problem. Instead, they show that, by properly
combining isostasy and a priori information, our method is able to
produce a set of estimated models exhibiting different 
amounts of isostatic equilibrium, but practically the same data fit. 
The differences are concentrated at the central part of the profile, where the
true lithostatic curve contains large variations. At the extremities, these models
are very similar to each other, the lithostatic curves are almost flat 
and the models are close to the isostatic equilibrium.

The results obtained with the model simulating the East Greenland margin illustrate
the case in which our method is applied to a margin presenting large deviations from
the local isostatic equilibrium. Figures 
\ref{fig:simple-model-step1}, \ref{fig:simple-model-step2-u0-2} and 
\ref{fig:simple-model-step2-u0-3} show results obtained with
a simple model (Table \ref{tab:simple-model}) that 
shows small variations in the lithostatic stress curve and can
be considered in local isostatic equilibrium along the entire profile, except at
the COT, located at $y_{COT} = 170$.
As we can see, the result obtained at the Step 1 (Figure \ref{fig:simple-model-step1}), 
without the isostatic constraint, is very good and shows estimated basement 
and Moho very close to the true ones.
Figure \ref{fig:simple-model-step2-u0-2} shows that, by using the isostatic constraint,
the estimated model is better than that obtained at Step 1, but the differences are small.
Notice that, differently for the result obtained with the model simulating the East Greenland 
margin (Figure \ref{fig:synt-margin-step2}), the use of the isostatic constraint does
not produce large residuals between the observed and predicted data. 
This is also the case for the result obtained by increasing the importance of the 
isostatic constraint (Figure \ref{fig:simple-model-step2-u0-3}). In this case, however,
we can see that the isostatic constraint produced a very poor estimated model.
The absence of large residuals between the observed and predicted data indicates
that the model can be considered in local isostatic equilibrium along the whole
profile.

We have also prepared additional test (in the form of (Supplementary material)) 
for investigating the (i) robustness of our method to the initial approximations used 
in the non-linear inversion, (ii) the sensitivity of our method to different combinations 
of constraints and the (iii) quantity of a priori information used at basement and Moho.
Our results show that, even by using initial approximations very different from each
other and from the true models, our method produce almost the same result at Step 2 and,
consequently, at Step 3 of our algorithm. 
They also show that the proposed constraints are not able to retrieve the true basement 
and Moho if they are used individually. 
Instead, the additional results show that our method is able to produce estimated models 
close to the true one by properly combining all the constraints.
Finally, they show that our method is not strongly dependent on the 
quantity of a priori information at the basement and Moho. This is an important issue 
because in real-world situations it can be very difficult to obtain such control points.


\section{Application to real data}


We applied our method to invert the gravity disturbance data 
on a profile located over the Pelotas basin
\citep{stica-etal2014}, southern of Brazil (Figure \ref{fig:pelotas-location}). This basin is 
considered a classical example of volcanic margin \citep{geoffroy2005}.
The gravity disturbance data are provided by the combined global gravity field model EIGEN-6C4
\citep{forste2014}, one of the latest releases of the ``European Improved Gravity model of 
the Earth by New techniques" series.
We have used data from ETOPO-1 to constraint the bathymetry along the profile
\citep{amante-eakins2009}.
Additionally, we have used a priori information about the basement and Moho depths
obtained from the seismic interpretations presented by \citet{stica-etal2014} and
\citet{zalan2015} to define the equality constraints 
(equations~\ref{eq:equality-constraint-basement} and \ref{eq:equality-constraint-moho})
and the initial approximation used in the non-linear inversion. 

Figures \ref{fig:pelotas-step1} and \ref{fig:pelotas-step2} show the estimated models 
obtained at Steps 1 and 2, respectively.
Parameters defining the interpretation model are shown in 
(Table~\ref{tab:pelotas-model}).
As we can see, the estimated model obtained at Step 2 produces a good data fit along 
the whole profile, except at region $\approx 150$ km.
Figures~\ref{fig:pelotas-step3-sgm7}, \ref{fig:pelotas-step3-sgm17dot6} and 
\ref{fig:pelotas-step3-sgm19} show estimated models obtained at
Step 3 by using different values for the parameter $\sigma$
(equation~\ref{eq:elements-wii}).
Differently from the model obtained at Step 2 (Figure~\ref{fig:pelotas-step2}), 
the new models show very good data fits along the entire profile.
The estimated lithostatic stress curves produced by these models 
show abrupt variations close to $150$ km and are practically flat on the remaining parts
of the profile. These results suggest that the margin is mostly in isostatic 
equilibrium, except at the region $\approx 150$.
Figure~\ref{fig:pelotas-step3-alternative} shows an alternative 
model obtained at Step 3. 
In this model, the parameter $\sigma$ (equation~\ref{eq:elements-wii}) and 
the density values in Layer 2 (sediment + SDR) are different from 
those used to obtain the models shown in Figures \ref{fig:pelotas-step3-sgm7},
\ref{fig:pelotas-step3-sgm17dot6} and \ref{fig:pelotas-step3-sgm19}.

The estimated models shown in Figures~\ref{fig:pelotas-step3-sgm17dot6} and 
\ref{fig:pelotas-step3-alternative} are close to those proposed by 
\citet{stica-etal2014} and \citet{zalan2015} (continuous black lines).
The larger differences ($\approx 10$ km) occur at the basement, along the first 
$100$ km of the profile.
At this region, \citeauthor{zalan2015} proposes a steep variation in basement
relief, which shows a maximum depth $\approx 30$ km.
These differences may be associated to the data we used to obtain our model.
We used satellite gravity data, whereas \citet{stica-etal2014} and \citet{zalan2015} used
gravity, magnetic and seismic sections available to the petroleum industry.
These differences may also be associated to lateral density variations which had 
not been included in our model, located in the sediment, SDR, crust or mantle. 
Alternatively, they might represent underplated mafic to ultra-mafic 
magma at the base of the crust, which would represent positive anomalous
masses and produce a gravity high. In order to compensate this high, the 
inversion would estimate a deeper basement, which would be closer to 
\citeauthor{zalan2015}'s model.
We do not attempt to propose a new model for the Pelotas basin, but show
how simple isostatic considerations can be combined with a priori information 
to explore the range of acceptable models.


\section{Conclusions}

We present a gravity inversion method for simultaneously estimating the 
geometries of basement and Moho, as well as the constant depth of the reference 
Moho on a profile crossing a passive rifted margin.
The method is formulated as a non-linear inverse problem by imposing local
isostatic equilibrium.
There are four main differences between our method and those in the literature.
The first is that, at each iteration of the non-linear inversion, 
our method estimates corrections for the geometries of basement and Moho simultaneously. 
It means that we do not estimate the Moho, use it to compute a residual gravity anomaly
and then invert these residual data to obtain the basement.
Another difference is that we do not use local isostasy to directly link
the geometries of basement and Moho.
Rather, we impose smoothness on the lithostatic stress exerted by the interpretation 
model on a constant compensation depth, below which there are no lateral density variations.
Our method also varies the weight of the isostatic constraint along the profile,
which is particularly useful for delimiting regions that deviate from the isostatic equilibrium.
Finally, our method also differs from those in the literature because it 
attempts to use isostasy for exploring (and not necessarily reducing) the inherent ambiguity of 
gravity methods.

Tests with synthetic data produced by a realistic model based on the East Greenland margin
show that our method can be used to successfully delimit regions conforming to and deviating
from the local isostatic equilibrium, as well as to generate a set of possible solutions that 
have different ``degrees of isostatic equilibrium" and produce equally good data fits.
The interpreter must choose the ``best estimated model" based on the 
available priori information and its knowledge about the study area.
Besides, these results show that the isostatic constraint can improve 
the estimated models at rifted margins showing pronounced crustal thinning.
The large variations in the basement and Moho reliefs at these margins induce
large variations in the lithostatic stress. 
This is a good scenario for using our isostatic constraint to explore different
models.
We also present results obtained with a simple model simulating a margin
close to the local isostatic equilibrium along the entire profile.
The basement and Moho surfaces in this simple model are relatively smooth.
As a consequence, the isostatic constraint does not improve the estimated
model significantly if compared to that obtained by using the smoothness
constraint.
Applications to real data over the Pelotas basin, considered a classical volcanic
margin at the southern of Brazil, produced results in agreement with a previous 
interpretation obtained independently.
Our results also delimit regions that can and cannot be considered 
in local isostatic equilibrium along the profile.

The problem of simultaneously estimating the geometries of basement and Moho surfaces
is very ambiguous and some simplifications must be made. 
One of these simplifications consists in considering bulk density 
values for each column forming the continental and oceanic crusts. 
The interpreter must predefine the function describing the horizontal density
variation of the crust along the profile, including the region close the COT.
In most practical situations, however, the interpreter will not have access to a detailed
description of the density variations within the crust and a regional approximation
will have to be used instead.
As a consequence, local errors in the estimated basement and Moho surfaces are expected 
at regions presenting local density variations in the deeper parts of continental crust 
and in the oceanic crust.
Another limitation of our method is that it requires a priori information about the
upper layers located below the water layer.
This information can be obtained, for example, from seismic data and be used to set
the densities of the layers located right below the ocean bottom.
If no a priori information is available at the study area, the interpreter will have to use
approximated values and test different models.
Errors in this approximation may negatively impact the estimated model, especially in 
the basement surface.
Further research could be conducted to generalize our method to estimate
three dimensional models, include lateral density variations in the upper mantle
and depth-dependent density distributions at the layers representing sediments.


%%%%%%%%%%%%%%%%%% Tables %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tabl{synt-margin-model}{Properties of the synthetic margin model simulating the
	East Greenland margin. 
	The model extends from $y = 0$ km to $y = 380$ km, the Continent-Ocean 
	Transition (COT) is located at $y_{COT} = 165$ km and the reference 
	Moho is located at $53$ km (Figures~\ref{fig:rifted-margin-model} and 
	\ref{fig:interpretation-model}).
	The density contrasts $\Delta\rho^{(\alpha)} = \rho^{(\alpha)} - \rho^{(r)}$ 
	were defined by using the reference value $\rho^{(r)} = 2850$ kg/m$^{3}$, 
	which coincides with the density $\rho^{(cc)}$ attributed to the continental crust.
	\label{tab:volcanic-margin-model}
}{
\begin{center}
	\begin{tabular}[]{lccc}
		\hline
		\textbf{Geological meaning} & $\rho^{(\alpha)}$ (kg/m$^{3}$) & $\Delta\rho^{(\alpha)}$ (kg/m$^{3}$) & $\alpha$ \\
		\hline
		water & $1030$ & $-1820$ & $w$ \\
		\hline
		sediments & $2600$ & $-250$ & $1$ \\
		\hline 
		continental crust & $2850$ & $0$ & $cc$ \\
		oceanic crust & $2885$ & $35$ & $oc$ \\
		\hline
		mantle & $3250$ & $400$ & $m$ \\
		\hline
	\end{tabular}
\end{center}
}

\tabl{simple-model}{Properties of the simple synthetic margin model. 
	The model extends from $y = 0$ km to $y = 250$ km, the Continent-Ocean 
	Transition (COT) is located at $y_{COT} = 170$ km and the reference 
	Moho is located at $46$ km (Figures~\ref{fig:rifted-margin-model} and 
	\ref{fig:interpretation-model}).
	The density contrasts $\Delta\rho^{(\alpha)} = \rho^{(\alpha)} - \rho^{(r)}$ 
	were defined by using the reference value $\rho^{(r)} = 2790$ kg/m$^{3}$, 
	which coincides with the density $\rho^{(cc)}$ attributed to the continental crust.
	\label{tab:simple-model}
}{
	\begin{center}
		\begin{tabular}[]{lccc}
			\hline
			\textbf{Geological meaning} & $\rho^{(\alpha)}$ (kg/m$^{3}$) & $\Delta\rho^{(\alpha)}$ (kg/m$^{3}$) & $\alpha$ \\
			\hline
			water & $1030$ & $-1790$ & $w$ \\
			\hline
			sediments & $2600$ & $-190$ & $1$ \\
			\hline 
			continental crust & $2790$ & $0$ & $cc$ \\
			oceanic crust & $2880$ & $90$ & $oc$ \\
			\hline
			mantle & $3250$ & $460$ & $m$ \\
			\hline
		\end{tabular}
	\end{center}
}

\tabl{pelotas-model}{Properties used in the Pelotas volcanic margin. 
	The interpretation model extends from $y = 0$ km to $y = 383$ km, the 
	Continent-Ocean Transition (COT) is located at $y_{COT} = 350$ km and the 
	reference Moho is located at $43 \, 200$ km (Figures~\ref{fig:rifted-margin-model} 
	and \ref{fig:interpretation-model}).
	The density contrasts $\Delta\rho^{(\alpha)} = \rho^{(\alpha)} - \rho^{(r)}$ 
	were defined by using the reference value $\rho^{(r)} = 2870$ kg/m$^{3}$, 
	which coincides with the density $\rho^{(cc)}$ attributed to the continental crust.
	\label{tab:pelotas-model}
}{
	\begin{center}
		\begin{tabular}[]{lccc}
			\hline
			\textbf{Geological meaning} & $\rho^{(\alpha)}$ (kg/m$^{3}$) & $\Delta\rho^{(\alpha)}$ (kg/m$^{3}$) & $\alpha$ \\
			\hline
			water & $1030$ & $-1840$ & $w$ \\
			\hline
			sediments & $2350$ & $-520$ & $1$ \\
			SDR & $2855$ & $-15$ & $2$ \\
			\hline 
			continental crust & $2870$ & $0$ & $cc$ \\
			oceanic crust & $2885$ & $15$ & $oc$ \\
			\hline
			mantle & $3240$ & $370$ & $m$ \\
			\hline
		\end{tabular}
	\end{center}
}


%%%%%%%%%%%%%%%%%% Tables %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%% Figures %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Methodology

\plot{rifted-margin-model-color}{width=0.8\textwidth}{
	{Rifted margin model formed by four layers. Layer 1 
	represents a water with constant density $\rho^{(w)}$. Layer 2 is
	split into $Q$ sub-layers according to the complexity of the study area. 
	In this example, $Q = 2$.
	These sub-layers represent sediments, salt or volcanic rocks and have constant 
	densities $\rho^{(q)}$, $q = 1, \dots, Q$. 
	Layer 3 represents the crust. In this example, its density $\rho{(c)}$ assumes two possible 
	values $\rho^{(cc)}$ and $\rho^{(oc)}$ representing, respectively, continental and oceanic crust. 
	More complex models can be generated by using a function
	describing the lateral density variations within the crust.
	Finally, Layer 4 represents a homogeneous mantle with constant density
	$\rho^{(m)}$. Basement, Moho and reference Moho are represented by the dashed-white lines. 
	The reference mass distribution is formed by an upper layer with constant density $\rho^{(r)}$
	and base at the reference Moho. Below this layer, we presume a reference distribution with the
	same constant density $\rho^{(m)}$ of the mantle.}
	\label{fig:rifted-margin-model}
}

\plot{interpretation-model-color}{width=0.8\textwidth}{
	{Interpretation model formed by $N$ columns of vertically stacked prisms. 
	Each column is formed by four layers of prisms and locally approximates the 
	rifted margin model shown in Figure~\ref{fig:rifted-margin-model-color}.
	Layer 2 is formed by $Q$ sub-layers according to the complexity of the study area. 
	In this example, $Q = 2$. 
	The thickness $t^{Q}_{i}$ and $t^{m}_{i}$ of the prisms forming, respectively, 
	the base of Layer 2 and the top of Layer 4 at the $i$-column are indicated.
	Each prism has a constant density contrast defined as the difference between
	its corresponding density at the rifted margin model 
	and the constant density $\rho^{(r)}$ of the shallowest layer forming
	the reference density distribution (Figure~\ref{fig:rifted-margin-model-color}).
	Basement, Moho and the reference Moho are represented by dashed-white lines. 
	The continuous black line represents the compensation depth
	at $S_{0}$. The reference Moho is located at $S_{0} + \Delta S$.}
	\label{fig:interpretation-model}
}

\plot{flow_diagram}{width=0.5\textwidth}{
	{Flow diagram of the algorithm. Steps 1, 2 and 3 are represented in blue, red and green,
	respectively. Diamonds, parallelograms and rectangles represent decision points, input parameters and intermediary processes, respectively. The end of the algorithm is represented
	by the rounded rectangle.  
	For convenience, we have omitted some input parameters related to the interpretation model 
	and the inversion (see the subsection \textit{Step 1}). Details about this flow diagram are
	explained at subsection Computational procedures for solving of the inverse problem.}
	\label{fig:flow-diagram}
}

%% application to synthetic data

%\plot{B-model-rifted-margin-grafics-estimated-model-alphas_X_X_X_1_2}{width=0.6\textwidth}{
%	{Application to synthetic data. Intermediate model $\mathbf{p}^{\prime}$ 
%	obtained at Step 1 (Figure~\ref{fig:flow-diagram}) by using
%	$\tilde{\mu}_{3} = 10^{1}$ and $\tilde{\mu}_{4} = 10^{2}$.
%	(Bottom panel) True and estimated surfaces,
%	initial basement and Moho (initial guess) and a 
%	priori information at points on basement and Moho (known depths).
%	(Middle panel) True and predicted lithostatic stress curves 
%	(equation~\ref{eq:lithostatic-stress-matrix}).
%	(Upper panel) Gravity disturbance produced by the true 
%	model (simulated data), estimated model (predicted data) and 
%	by the initial guess (initial guess data). 
%	The density contrasts are those shown in 
%	Table~\ref{tab:volcanic-margin-model} and $S_{0} = 48$ km.}
%	\label{fig:synt-margin-p-prime}
%}

\plot{B-model-rifted-margin-grafics-estimated-model-alphas_X_1_2_1_2-2pts}{width=0.6\textwidth}{
	{Application to synthetic data produced by the model simulating the
	East Greenland margin. 
	Estimated model $\mathbf{p}^{(1)}$ 
	obtained at the end of Step 1 (Figure~\ref{fig:flow-diagram}) by
	using $\tilde{\mu}_{1} = 10^{1}$ and $\tilde{\mu}_{2} = 10^{2}$.
	(Bottom panel) True and estimated surfaces,
	initial basement and Moho (initial guess) and a 
	priori information at points on basement and Moho (known depths).
	(Middle panel) True and predicted lithostatic stress curves 
	(equation~\ref{eq:lithostatic-stress-matrix}).
	(Upper panel) Gravity disturbance produced by the true 
	model (simulated data), estimated model (predicted data) and 
	by the initial guess (initial guess data). 
	The density contrasts are those shown in 
	Table~\ref{tab:volcanic-margin-model} and $S_{0} = 48$ km.}
	\label{fig:synt-margin-step1}
}

\plot{B-model-rifted-margin-grafics-estimated-model-alphas_3_1_2_1_2-2pts}{width=0.6\textwidth}{
	{Application to synthetic data produced by the model simulating the
	East Greenland margin. Estimated model $\mathbf{p}^{(2)}$ 
	obtained at the end of Step 2 (Figure~\ref{fig:flow-diagram}) by
	using $\tilde{\mu}_{0} = 10^{3}$.
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:synt-margin-step1}.}
	\label{fig:synt-margin-step2}
}

\plot{B-model-rifted-margin-grafics-estimated-model-alphas_3_1_2_1_2-sgm_1-2pts}{width=0.6\textwidth}{
	{Application to synthetic data produced by the model simulating the
	East Greenland margin. Estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}) by
	using $\mathbf{p}^{(2)}$ (Figure~\ref{fig:synt-margin-step2}) as
	initial approximation (dashed blue lines) and
	$\sigma = 1$ (equation~\ref{eq:elements-wii}).
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:synt-margin-step1}.}
	\label{fig:synt-margin-step3-sgm1}
}

\plot{B-model-rifted-margin-grafics-estimated-model-alphas_3_1_2_1_2-sgm_11-2pts}{width=0.6\textwidth}{
	{Application to synthetic data produced by the model simulating the
	East Greenland margin. Estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}) by
	using $\mathbf{p}^{(2)}$ (Figure~\ref{fig:synt-margin-step2}) as
	initial approximation (dashed blue lines) and
	$\sigma = 11$ (equation~\ref{eq:elements-wii}).
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:synt-margin-step1}.}
	\label{fig:synt-margin-step3-sgm11}
}

\plot{B-model-rifted-margin-grafics-estimated-model-alphas_3_1_2_1_2-sgm_18-2pts}{width=0.6\textwidth}{
	{Application to synthetic data produced by the model simulating the
	East Greenland margin. Estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}) by
	using $\mathbf{p}^{(2)}$ (Figure~\ref{fig:synt-margin-step2}) as
	initial approximation (dashed blue lines) and
	$\sigma = 18$ (equation~\ref{eq:elements-wii}).
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:synt-margin-step1}.}
	\label{fig:synt-margin-step3-sgm18}
}

\plot{E-model-rifted-margin-grafics-estimated-model-alphas_X_1_2_1_2}{width=0.6\textwidth}{
	{Application to synthetic data produced by a simple model. 
	Estimated model $\mathbf{p}^{(1)}$ 
	obtained at the end of Step 1 (Figure~\ref{fig:flow-diagram}) by
	using $\tilde{\mu}_{1} = 10^{1}$, $\tilde{\mu}_{2} = 10^{2}$,
	$\tilde{\mu}_{3} = 10^{1}$ and $\tilde{\mu}_{4} = 10^{2}$.
	(Bottom panel) True and estimated surfaces,
	initial basement and Moho (initial guess) and a 
	priori information at points on basement and Moho (known depths).
	(Middle panel) True and predicted lithostatic stress curves 
	(equation~\ref{eq:lithostatic-stress-matrix}).
	(Upper panel) Gravity disturbance produced by the true 
	model (simulated data), estimated model (predicted data) and 
	by the initial guess (initial guess data). 
	The density contrasts are those shown in 
	Table~\ref{tab:simple-model} and $S_{0} = 40$ km.}
	\label{fig:simple-model-step1}
}

\plot{E-model-rifted-margin-grafics-estimated-model-alphas_2_1_2_1_2}{width=0.6\textwidth}{
	{Application to synthetic data produced by a simple model. 
	Estimated model $\mathbf{p}^{(2)}$ 
	obtained at the end of Step 2 (Figure~\ref{fig:flow-diagram}) by
	using $\tilde{\mu}_{0} = 10^{2}$.
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:simple-model-step1}.}
	\label{fig:simple-model-step2-u0-2}
}

\plot{E-model-rifted-margin-grafics-estimated-model-alphas_3_1_2_1_2}{width=0.6\textwidth}{
	{Application to synthetic data produced by a simple model. 
		Estimated model $\mathbf{p}^{(2)}$ 
		obtained at the end of Step 2 (Figure~\ref{fig:flow-diagram}) by
		using $\tilde{\mu}_{0} = 10^{3}$.
		The remaining information is the same shown in the caption of
		Figure~\ref{fig:simple-model-step1}.}
	\label{fig:simple-model-step2-u0-3}
}



%% application to real data

\plot{map-line-localization}{width=0.8\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Gravity disturbance
	provided by the global gravity field model EIGEN-6C4 \citep{forste2014} at
	the study area. The black straight line indicates the gravity profile over the Pelotas
	basin. The end points of the profile have coordinates (geodetic latitude and longitude) 
	$(-27.72, -48.23)$ and $(-29.66, -44.94)$. The coordinates are referred to the 
	WGS84 datum.}
	\label{fig:pelotas-location}
}

\plot{pelotas-profile-grafics-estimated-model-alphas_X_1_2_1_2}{width=0.6\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Estimated model $\mathbf{p}^{(1)}$ 
	obtained at the end of Step 1 (Figure~\ref{fig:flow-diagram}) by
	using $\tilde{\mu}_{1} = 10^{1}$, $\tilde{\mu}_{2} = 10^{2}$,
	$\tilde{\mu}_{3} = 10^{1}$ and $\tilde{\mu}_{4} = 10^{2}$.
	(Bottom panel) Estimated surfaces, initial basement and Moho (initial guess) 
	and a priori information at basement and Moho (known depths).
	The continuous black lines represent a previous interpretation presented 
	by \citet{zalan2015}.
	(Middle panel) True and predicted lithostatic stress curves 
	(equation~\ref{eq:lithostatic-stress-matrix}).
	(Upper panel) Observed gravity disturbance, data produced by the estimated
	model (predicted data) and data produced the by the initial approximation (initial guess data).
	We used $S_{0} = 41$ km, density contrasts equal to those shown in Table~\ref{tab:pelotas-model}
	and initial approximation for $\Delta S$ equal to $1$ km.}
	\label{fig:pelotas-step1}
}

\plot{pelotas-profile-grafics-estimated-model-alphas_2_1_2_1_2}{width=0.6\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Estimated model $\mathbf{p}^{(2)}$ 
	obtained at the end of Step 2 (Figure~\ref{fig:flow-diagram}) by
	using $\tilde{\mu}_{0} = 10^{2}$.
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:pelotas-step1}.}
	\label{fig:pelotas-step2}
}

\plot{pelotas-profile-grafics-estimated-model-alphas_2_1_2_1_2-sgm_7}{width=0.6\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}) by
	using $\mathbf{p}^{(2)}$ (Figure~\ref{fig:pelotas-step2}) as
	initial approximation (dashed blue lines) and
	$\sigma = 7$ (equation~\ref{eq:elements-wii}).
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:pelotas-step1}.}
	\label{fig:pelotas-step3-sgm7}
}

\plot{pelotas-profile-grafics-estimated-model-alphas_2_1_2_1_2-sgm_17dot6}{width=0.6\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}) by
	using $\mathbf{p}^{(2)}$ (Figure~\ref{fig:pelotas-step2}) as
	initial approximation (dashed blue lines) and
	$\sigma = 17.6$ (equation~\ref{eq:elements-wii}).
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:pelotas-step1}.}
	\label{fig:pelotas-step3-sgm17dot6}
}

\plot{pelotas-profile-grafics-estimated-model-alphas_2_1_2_1_2-sgm_19}{width=0.6\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}) by
	using $\mathbf{p}^{(2)}$ (Figure~\ref{fig:pelotas-step2}) as
	initial approximation (dashed blue lines) and
	$\sigma = 19$ (equation~\ref{eq:elements-wii}).
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:pelotas-step1}.}
	\label{fig:pelotas-step3-sgm19}
}

\plot{pelotas-profile-grafics-estimated-model-alphas_2_1_2_1_2-sgm_17-T07}{width=0.6\textwidth}{
	{Application to real data on Pelotas basin, Brazil. Alternative estimated model $\mathbf{p}^{(3)}$ 
	obtained at the end of Step 3 (Figure~\ref{fig:flow-diagram}). 
	The differences between this model and those shown in Figures \ref{fig:pelotas-step3-sgm7},
	\ref{fig:pelotas-step3-sgm17dot6} and \ref{fig:pelotas-step3-sgm19} are the
	densities $\rho^{(1)}$ and $\rho^{(2)}$ attributed to the sediments
	and SDR (Table~\ref{tab:pelotas-model}), as well as the parameter 
	$\sigma$ (equation~\ref{eq:elements-wii}).
	In this alternative model, $\rho^{(1)} = 2425$ kg/m$^{3}$,
	$\rho^{(2)} = 2835$ kg/m$^{3}$ and $\sigma = 17$.
	The remaining information is the same shown in the caption of
	Figure~\ref{fig:pelotas-step1}.}
	\label{fig:pelotas-step3-alternative}
}

%%%%%%%%%%%%%%%%%% Figures %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{ACKNOWLEDGMENTS}

%\lipsum[1]


\newpage

\bibliographystyle{seg.bst}  % style file is seg.bst
\bibliography{bib-file.bib}


\end{document}

